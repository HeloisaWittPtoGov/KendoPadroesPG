<script>
  $(function () {

    //-----------------------------------------------------------------------------------//
    // Instanciando os campos da tela de cadastro
    //-----------------------------------------------------------------------------------//
    $("#frmCadastroLivro #flgenero").kendoDropDownList({})

    $("#frmCadastroLivro #nrpaginas").kendoNumericTextBox()

    $("#frmCadastroLivro #dtpublicacao").kendoDatePicker({
      format: "dd/MM/yyyy"
    })

    $("#frmCadastroLivro #dtpublicacao").kendoMaskedTextBox({
      mask: "00/00/0000"
    })
    //-----------------------------------------------------------------------------------//

    //-----------------------------------------------------------------------------------//
    //Barra de Ações
    //-----------------------------------------------------------------------------------//
    $("#frmCadastroLivro #BarAcoes").kendoToolBar({
      items: [
        {
          type: "spacer",
        },
        {
          type: "buttonGroup",
          buttons: [
            {
              id: "BtnGravar",
              spriteCssClass: "k-pg-icon k-i-l1-c5",
              text: "Gravar",
              group: "actions",
              attributes: {
                "tabindex": "30"
              },
              click: function () {
                let nrIdCadastro = $("#idlivro").val()
                let nrIndiceId = arrLivros.findIndex(i => i.idlivro === nrIdCadastro)

                let strMensagem = ""

                if (("#WinCadastroLivro #dstitulo").val().trim() == "") {
                  strMensagem = strMensagem + "O campo título é de preenchimento obrigatório.\n"
                } else {
                  let dsTituloInformado = $("#WinCadastroLivro #dstitulo").val().trim().toLowerCase()
                  let strVerificaTitulo = arrLivros.find(function (i) {
                    return i.dsTitulo.trim().toLowerCase() == dsTituloInformado && i.idLivro != i.nrIdCadastro
                  })
                  if (verificaTitulo) {
                    strMensagem = strMensagem + "Já Existe um livro cadastrado com o titulo informado.\n"
                  }
                }
                if ($("#WinCadastroLivro #nmautor").val().trim() = "") {
                  strMensagem = strMensagem + "O campo Autor é de preenchimento obrigatório.\n"
                }
                if ($("#WinCadastroLivro #flgenero").val().trim() = "") {
                  strMensagem = strMensagem + "O campo Genero é de preenchimento obrigstório.\n"
                }
                if ($("#WinCadastroLivro #nrpagina").val().trim() <= 0) {
                  strMensagem = strMensagem + "O numero de páginas deve ser superior a zero."
                }
                if (strMensagem != "") {
                  alert(strMensagem)
                }
              }
            },
            {
              id: "BtnExcluir",
              spriteCssClass: "k-pg-icon k-i-l1-c7",
              text: "Excluir",
              group: "actions",
              attributes: {
                "tabindex": "31"
              },
            },
            {
              id: "BtnLimpar",
              spriteCssClass: "k-pg-icon k-i-l1-c6",
              text: "Limpar",
              group: "actions",
              attributes: {
                "tabindex": "32"
              },
            },
            {
              id: "BtnFechar",
              spriteCssClass: "k-pg-icon k-i-l1-c4",
              text: "Fechar",
              group: "actions",
              attributes: {
                "tabindex": "33"
              },
            }
          ]
        }
      ]
    })
    //-----------------------------------------------------------------------------------//

    //-----------------------------------------------------------------------------------//
    // Ações diversas da tela de manutenção
    //-----------------------------------------------------------------------------------//
    // Açõa para centralizar a janela
    $("#WinCadastroLivro").data("kendoWindow").center().open()
    //-----------------------------------------------------------------------------------//

  })
</script>

<form id="frmCadastroLivro" enctype="multipart/form-data">
  <div class="k-form">
    <table>
      <tr>
        <td style="text-align: right; width: 120px;">
          ID:
        </td>
        <td>
          <input id="idlivro" type="text" class="k-textbox k-input-disabled" style="width: 80px;">
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td style="text-align: right; width: 120px;">
          Titulo:
        </td>
        <td>
          <input id="nmtitulo" type="text" class="k-textbox" style="width: 600px">
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td style="text-align: right; width: 120px;">
          Autor:
        </td>
        <td>
          <input id="nmautor" type="text" class="k-textbox" style="width: 600px;">
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td style="text-align: right; width: 120px;" class="k-required">
          Genero:
        </td>
        <td>
          <select id="flgenero" style="width: 600px;">
            <option value="SP">Suspense</option>
            <option value="TR">Terror</option>
            <option value="RM">Romance</option>
          </select>
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td style="text-align: right; width: 120px;" class="k-required">
          Numero de Páginas:
        </td>
        <td>
          <input id="nrpaginas" style="width: 80px;">
        </td>
        <td style="text-align: right; width: 391px;" class="k-required">
          Data de Publicação:
        </td>
        <td>
          <input id="dtpublicacao" style="width: 120px;">
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <input id="fldisponivel" type="checkbox" style="margin-left: 124px;" class="k-checkbox">
          <label for="fldisponivel" class="checkbox-label">Disponivel</label>
        </td>
      </tr>
    </table>
    <div id="BarAcoes" style="text-align: right; border-bottom-width: 0px; height: 28px;"></div>
  </div>

</form>